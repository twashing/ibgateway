<!DOCTYPE html>
<html>
  <head>

    <title>Edgarly</title>
    <link rel="icon" href="data:;base64,iVBORw0KGgo=">
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet">

    <style>
      .colleague {
        font-style: italic;
        color: #999; }
    </style>

    <!-- Typekit -->
    <script src="https://use.typekit.net/ktm4usi.js"></script>
    <script>try{Typekit.load({ async: true });}catch(e){}</script>

    <!-- <script src= "/js/highstock.js" type="text/javascript"></script> -->
    <script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
    <script src="https://code.highcharts.com/stock/highstock.js"></script>
    <script src="https://code.highcharts.com/stock/modules/exporting.js"></script>
    <script src="https://code.highcharts.com/stock/modules/export-data.js"></script>
  </head>

  <body fullbleed vertical layout>

      <div class="tk-league-gothic" style="font-size:3em">Gently</div>
      <div class="tk-open-sans">A Rich Internet Applicaiton Baseline</div>

      <div id="container" style="width:100%; height:400px;"></div>


    <!-- Ensuring users of IE can't use Compatibility Mode, as this will break Persona.
         (https://developer.mozilla.org/en-US/Persona/Quick_setup) -->
    <meta http-equiv="X-UA-Compatible" content="IE=Edge">

    <!-- <script src= "js/compiled/gently.js" type="text/javascript"></script> -->
    <script>

     function loadData() {
         $.getJSON('/aapl-c.json', function (data) {

             console.log(data);
             Highcharts.stockChart('container', {
                 rangeSelector: {
                     selected: 1
                 },
                 title: {
                     text: 'TSLA Stock Price'
                 },
                 series: [{
                     name: 'TSLA',
                     data: data,
                     tooltip: {
                         valueDecimals: 2
                     }
                 }]
             })})
     };

     $('document').ready(function(){

         loadData();

         w = new WebSocket("ws://localhost:8080/ws")
         w.onmessage = function(e) {

             console.log(eval(e.data));
             Highcharts.charts[0].series[0].addPoint(eval(e.data), true, true);
             // Highcharts.charts[0].series[1].addPoint(eval(e.data), true, true);
         }
         w.onclose = function(e) {  console.log("The connection to the server has closed."); }
         // w.send("Hello from the Client!");
     });

    </script>
  </body>
</html>
